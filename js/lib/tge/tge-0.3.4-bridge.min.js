TGE.KeyframedAnimation=function(e,f,d,a,b){this.mAnimationPlayer=e;this.mAnimationID=f;this.mPartInstances=d;this.mLooping=a;this.mFinishedCallback=b;this.mSmoothTransitions=false;this.mAge=0;this.mPaused=false;if(!this.mAnimationPlayer.AnimationExists(f)){this.Cancel();console.log("***** ERROR: keyframed animation not found: '"+f+"'")}return this};TGE.KeyframedAnimation.prototype={Pause:function(){this.mPaused=true},Resume:function(){this.mPaused=false},Update:function(a){if(this.mPaused){return}this.mAge+=a;this.mAnimationPlayer.PosePartInstances(this.mPartInstances,this.mAnimationID,this.mAge,this.mLooping,this.mSmoothTransitions)},Cancel:function(){this.mFinishedCallback=null;this.Pause()}};TGE.KeyframedAnimationPlayer=function(a){this.mData=null;this.mImageTag=null;if(a.parts===undefined||a.part_instances===undefined||a.animations===undefined||a.max_children===undefined||a.framerate===undefined){return this}this.mData=a;this.mInverseGlobalScale=1/a.image_scale;return this};TGE.KeyframedAnimationPlayer.prototype={Valid:function(){return this.mData!==null},GetAnimations:function(){return this.Valid()?this.mData.animations:null},NumRequiredPartInstances:function(){return this.Valid()?this.mData.max_children:0},AnimationExists:function(a){return this.Valid()?this.mData.animations[a]!==undefined:false},PosePartInstances:function(j,g,q,t,e){if(!this.Valid()){return}var C=this.mData.animations[g];var z=C.frames.length;var u=z/this.mData.framerate;var y=Math.floor(q/u);var A=(!t&&y>=1)?z-1:((q-(y*u))/u)*z;var l=Math.floor(A);var k=C.frames[l];var w=(l+1)%z;var v=C.frames[w];var B=j.length;var r=k.instances.length;for(var s=0;s<B;s++){var m=j[s];if(s>=r){m.visible=false}else{var E=k.instances[s];var f=this.mData.part_instances[E.i];var x=this.mData.parts[f];var o=this.mImageTag===null?f:this.mImageTag+"_"+f;m.setImage(o);m.registrationX=x.regx;m.registrationY=x.regy;var J=E.a;var H=E.b;var F=E.c;var D=E.d;var I=E.x;var G=E.y;if(e){var h=v.instances[v.instances_map[E.i]];if(h!==undefined){var n=A-l;J=E.a+(h.a-E.a)*n;H=E.b+(h.b-E.b)*n;F=E.c+(h.c-E.c)*n;D=E.d+(h.d-E.d)*n;I=E.x+(h.x-E.x)*n;G=E.y+(h.y-E.y)*n}}J*=this.mInverseGlobalScale;H*=this.mInverseGlobalScale;F*=this.mInverseGlobalScale;D*=this.mInverseGlobalScale;m.setLocalTransform(J,H,F,D,I,G);m.visible=true}}}};TGE.SpriteAnimation=function(e,g,d,b,h,f,a){this.mFPS=f;this.mNumberOfFrames=h;this.mLooping=a;this.mAge=0;this.mPaused=false;this.mFinishedCallback=null;this.mFrameOffset=0;this.mCurrentFrame=0;this.mSprite=new TGE.Sprite();this.mSprite.setImage(g,d,b);this.mSprite.visible=false;e.addChild(this.mSprite);this.mSprite.registrationX=e.registrationX;this.mSprite.registrationY=e.registrationY};TGE.SpriteAnimation.prototype={Play:function(a){this.mAge=0;this.mFinishedCallback=a;this.mSprite.setSpriteIndex(0);this.mSprite.visible=true},Pause:function(){this.mPaused=true},Stop:function(){this.mSprite.visible=false},Resume:function(){this.mPaused=false},SetAnimationIndexOffset:function(a){this.mFrameOffset=a},Update:function(a){if(!this.mPaused){this.mAge+=a}var d=1/this.mFPS;var b=Math.floor(this.mAge/d);this.mCurrentFrame=0;if(this.mLooping||b<this.mNumberOfFrames){this.mCurrentFrame=b%this.mNumberOfFrames}else{this.mCurrentFrame=this.mNumberOfFrames-1;if(this.mFinishedCallback!=null){this.mFinishedCallback.call();this.mFinishedCallback=null}}this.mCurrentFrame+=this.mFrameOffset;this.mSprite.setSpriteIndex(this.mCurrentFrame)}};TGE.ScreenEntity=function(a){TGE.ScreenEntity.superclass.constructor.call(this);this.mGame=a;this.mAge=0;this.mAnimations=[];this.mCurrentAnimation=null;this.mKeyframedAnimationPlayer=null;this.mAnimationPartInstances=[];this.mCurrentKeyframedAnimation=null;this.mCurrentKeyframedAnimationID=null;this.addEventListener("update",this._updateWrapper.bind(this));if(typeof(this.MouseUp)==="function"||typeof(this.MouseDown)==="function"){this.addEventListener("mousedown",this._mouseDownWrapper.bind(this));this.addEventListener("mouseup",this._mouseUpWrapper.bind(this))}};TGE.ScreenEntity.prototype={_mCameraCulling:null,Setup:function(b,e,d,a){this.mLayer=a;this.x=b;this.y=e;this.setImage(this.mGame.GetImage(d));this.mGame.getLayer(this.mLayer).addChild(this);return this},SetImage:function(b,d,a){var e=this.mGame.GetImage(b);if(e==null){return}d=typeof d!=="undefined"?d:1;a=typeof a!=="undefined"?a:1;this.setImage(e,d,a)},LoadAnimation:function(j,d,f,e,h,g,b){var a=new TGE.SpriteAnimation(this,this.mGame.GetImage(d),f,e,h,g,b);this.mAnimations[j]=a},PlayAnimation:function(b,a){if(this.mCurrentAnimation==this.mAnimations[b]){return}this.PlayAnimationFromStart(b,a)},PlayAnimationFromStart:function(d,a){var b=this.mAnimations[d];if(b!=null){if(this.mCurrentAnimation!==null){this.mCurrentAnimation.Stop()}this.setImage(null);this.mCurrentAnimation=b;this.mCurrentAnimation.Play(a);this.width=this.mCurrentAnimation.mSprite.width;this.height=this.mCurrentAnimation.mSprite.height}},removeCurrentAnimation:function(){if(this.mCurrentAnimation!==null){this.mCurrentAnimation.Stop()}this.setImage(null);this.mCurrentAnimation=null;this.width=this.height=0;this._boundingInfoDirty=true},InitializeKeyframedAnimations:function(d){this.mKeyframedAnimationPlayer=d;this.mKeyframedAnimationPlayer.InitializeImages(this.mGame);if(this.mCurrentKeyframedAnimation!==null){this.mCurrentKeyframedAnimation.Cancel()}if(this.mAnimationPartInstances.length>0){var b=this.mAnimationPartInstances.length;for(var f=0;f<b;f++){this.mAnimationPartInstances[f].markForRemoval()}}this.mAnimationPartInstances=[];var e=this.mKeyframedAnimationPlayer.NumRequiredPartInstances();for(var f=0;f<e;f++){var a=this.addChild(new TGE.Sprite());a.visible=false;this.mAnimationPartInstances.push(a)}},PlayKeyframedAnimation:function(d,a,b){if(this.mCurrentKeyframedAnimationID===d){return}this.PlayKeyframedAnimationFromStart(d,a,b)},PlayKeyframedAnimationFromStart:function(d,a,b){if(typeof(a)==="undefined"){a=true}if(typeof(b)==="undefined"){b=null}if(this.mCurrentKeyframedAnimation!==null){this.mCurrentKeyframedAnimation.Cancel()}this.mCurrentKeyframedAnimation=new TGE.KeyframedAnimation(this.mKeyframedAnimationPlayer,d,this.mAnimationPartInstances,a,b);this.mCurrentKeyframedAnimationID=d},Age:function(){return this.mAge},_updateWrapper:function(a){this.Update(a.elapsedTime)},_mouseDownWrapper:function(a){this.MouseDown()},_mouseUpWrapper:function(a){this.MouseUp()},Update:function(a){this.mAge+=a;this.subclassUpdate(a);if(this.ShouldBeRemoved()){this.markForRemoval()}if(this.mCurrentAnimation!=null){this.mCurrentAnimation.Update(a)}if(this.mCurrentKeyframedAnimation!==null){this.mCurrentKeyframedAnimation.Update(a)}},ShouldBeRemoved:function(){if(this._mCameraCulling!==null){var a=this.getBounds();if(this._mCameraCulling[0]&&a.y+a.height<0){return true}if(this._mCameraCulling[1]&&a.x>this.mGame.Width()){return true}if(this._mCameraCulling[2]&&a.y>this.mGame.Height()){return true}if(this._mCameraCulling[3]&&a.x+a.width<0){return true}}return this.subclassShouldBeRemoved()},subclassUpdate:function(a){},subclassShouldBeRemoved:function(){return false},subclassCleanup:function(){},_updateScreenPosition:function(){},MarkedForRemoval:function(){return this.markedForRemoval()},SetRotation:function(a){this.rotation=a},SetScale:function(b,a){a=typeof a==="undefined"?b:a;this.scaleX=b;this.scaleY=a},SetAlpha:function(a){this.alpha=a},Width:function(){return this.width},Height:function(){return this.height},Show:function(){this.visible=true},Hide:function(){this.visible=false},Visible:function(){return this.visible}};extend(TGE.ScreenEntity,TGE.Sprite);TGE.GameWorldEntity=function(a){TGE.ScreenEntity.call(this,a);this.worldPosition=new TGE.Point();this.addEventListener("camerachange",this._updateScreenPosition)};TGE.GameWorldEntity.prototype={_mLockXPosition:false,Setup:function(b,e,d,a){this.mLayer=a;this.SetWorldPosition(b,e);this.setImage(this.mGame.GetImage(d));this.mGame.getLayer(this.mLayer).addChild(this);return this},SetWorldPosition:function(a,b){this.worldPosition.x=a;this.worldPosition.y=b},CullToCamera:function(e,b,a,d){this._mCameraCulling=[e,b,a,d]},WorldPosition:function(){return this.mWorldPosition},LockXPosition:function(){this._mLockXPosition=true},_updateScreenPosition:function(b){var a=this._mLockXPosition?this.worldPosition.x:(this.stage.width/2)+(this.worldPosition.x-b.cx);var d=(this.stage.height/2)-(this.worldPosition.y-b.cy);this.x=a;this.y=d}};extend(TGE.GameWorldEntity,TGE.ScreenEntity,null);TGE.Screen=function(a){this.mScreenManager=a;this.mBackground=null;this.mUIElements=new Array();this.mDestroyed=false};TGE.Screen.prototype={Setup:function(){},Close:function(){this.mScreenManager.CloseScreen(this.constructor)},Game:function(){return this.mScreenManager.Game()},CreateUIEntity:function(a){var b=this.mScreenManager.CreateUIEntity(a);this.mUIElements.push(b);return b},DisplayNumber:function(b,j,h,o,f,g,q,u){var m=this.CreateUIEntity(TGE.ScreenEntity).Setup(j,h,null,u);var a=b.toString();var d=24;var p=2;var e=a.length*f;if(q){var s=Math.floor((a.length-1)/3);e+=s*d;e-=s*p}var l=g=="center"?e/2+f/2:e;l-=f;var k=0;var r=0;for(i=a.length-1;i>=0;i--){if(q&&r==3){l+=p;var t=new TGE.Sprite();t.setImage("big_digits_comma");t.x=l;t.y=k;m.addChild(t);l-=d;r=0}var n=new TGE.Sprite();n.setImage(o,1,10);n.setSpriteIndex(a.charCodeAt(i)-48);n.x=l;n.y=k;m.addChild(n);l-=f;r++}return m},FillBackground:function(a){this.mBackground=this.mScreenManager.Game().CreateUIEntity(TGE.ScreenEntity);this.mBackground.Setup(0,0,null,this.mScreenManager.mLayerName);this.mBackground.registrationX=0;this.mBackground.registrationY=0;this.mBackground.width=this.mScreenManager.Game().Width();this.mBackground.height=this.mScreenManager.Game().Height();this.mBackground.backgroundColor=a},Finalize:function(){},ShowAll:function(){for(var a=0;a<this.mUIElements.length;a++){this.mUIElements[a].visible=true}},HideAll:function(){for(var a=0;a<this.mUIElements.length;a++){this.mUIElements[a].visible=false}},Update:function(a){},Destroy:function(){if(this.mBackground!=null){this.mBackground.markForRemoval()}for(var a=0;a<this.mUIElements.length;a++){this.mUIElements[a].markForRemoval()}this.mDestroyed=true},handleEvent:function(a){}};TGE.ScreenManager=function(a){this.mGame=a;this.mLayerName="ScreenManager";this.mScreens=new Array();this.mFadeIn=null;this.mFadeInAlpha=1;this.mFadeInSpeed=1;this.mFadeInColor=null};TGE.ScreenManager.prototype={Initialize:function(b){for(var a in this.mScreens){if(this.mScreens[a]!=null){this.mScreens[a].Destroy();this.mScreens[a]=null}}b.CreateLayer(this.mLayerName);b.CreateLayer("FadeOverlay")},setupFadeIn:function(a,b){this.mFadeInSpeed=b;this.mFadeInColor=a},CreateUIEntity:function(a){return this.mGame.CreateUIEntity(a)},ShowScreen:function(e,a){var b=new e;e.prototype.constructor.apply(b,[this]);var d=e.className?e.className():e.name;this.mScreens[d]=b;b.Setup();b.Finalize();a=typeof a==="undefined"?true:a;if(a!=false){this.ResetFade()}return b},CloseScreen:function(d){var b=d.className?d.className():d.name;var a=this.mScreens[b];if(a==null){return}a.Destroy();this.mScreens[d]=null},ResetFade:function(){if(this.mFadeInColor!==null){if(this.mFadeIn===null){this.mFadeIn=new TGE.DisplayObject();this.mFadeIn.width=this.mGame.Width();this.mFadeIn.height=this.mGame.Height();this.mFadeIn.registrationX=0;this.mFadeIn.registrationY=0;this.mFadeIn.backgroundColor=this.mFadeInColor;this.mGame.getLayer("FadeOverlay").addChild(this.mFadeIn)}if(this.mGame.getLayer("FadeOverlay").getChildIndex(this.mFadeIn)===-1){this.mGame.getLayer("FadeOverlay").addChild(this.mFadeIn)}this.mFadeInAlpha=1;this.mFadeIn.alpha=1;this.mFadeIn.visible=true}},Update:function(b){if(this.mFadeIn!==null&&this.mFadeInColor!==null){this.mFadeInAlpha-=b/this.mFadeInSpeed;if(this.mFadeInAlpha<=0){this.mFadeInAlpha=0;this.mFadeIn.visible=false}this.mFadeIn.alpha=this.mFadeInAlpha}for(var a in this.mScreens){if(this.mScreens[a]!=null){this.mScreens[a].Update(b)}}},Game:function(){return this.mGame},XFromPercentage:function(a){return this.mGame.Width()*a},YFromPercentage:function(a){return this.mGame.Height()*a},FixedDistanceFromTop:function(a){return a},FixedDistanceFromBottom:function(a){return this.mGame.Height()-a},FixedDistanceFromLeft:function(a){return a},FixedDistanceFromRight:function(a){return this.mGame.Width()-a}};TGE.Text.prototype.Setup=function(h,g,k,a,b,f,d,j){this.x=h;this.y=g;this.mLayer=j;if(this.stage){var e=this.stage.getChildByName(this.mLayer,false);e=e===null?this.stage:e;e.addChild(this)}else{TGE.log("***** ERROR: objects created with TGE 0.3 and below must be instantiated with TGE.CreateWorldObject or TGE.CreateUIObject")}this.text=k;this.font=a;this.hAlign=b;this.vAlign=f;this.textColor=d;return this};TGE.Text.prototype._calculateDimensions=function(a){};TGE.Button.prototype.Setup=function(b,h,f,e,d,a){this.x=b;this.y=h;this.mLayer=a;if(this.stage){var g=this.stage.getChildByName(this.mLayer,false);g=g===null?this.stage:g;g.addChild(this)}else{TGE.log("***** ERROR: objects created with TGE 0.3 and below must be instantiated with TGE.CreateWorldObject or TGE.CreateUIObject")}this._mNumStates=d;this.setImage(f,1,d);this.pressFunction=e;this._setButtonState("idle");return this};TGE.ParallaxPane.prototype.Setup=function(b,g,f,a,d){if(this.stage){var e=this.stage.getChildByName(a,false);e=e===null?this.stage:e;e.addChild(this)}else{TGE.log("***** ERROR: objects created with TGE 0.3 and below must be instantiated with TGE.CreateWorldObject or TGE.CreateUIObject")}d=(typeof d==="undefined"?false:d);return this.setup({worldY:b,image:f,trackingSpeed:g,vertical:d})};TGE.ParallaxPane.prototype.SetHorizontalOffset=function(a){this.offset=a};TGE.Sprite.prototype.SetImage=function(b,d,a){this.setImage(b,d,a)};TGE.Achievement=function(e,b,d,a){this._id=e;this._earned=false;this.name=b;this.description=d;this.imageID=a;return this};TGE.Achievement.prototype={_id:null,earned:function(){this._earned=true},hasBeenEarned:function(){return this._earned},id:function(){return this._id}};TGE.Achievements=function(){this.lockedIconID=null;this.earnedAchievementCallback=null;return this};TGE.Achievements.HigherScoresAreBetter=true;TGE.Achievements.BestScore=null;TGE.Achievements._FRIENDSTER_API_URL="http://www.littlegrey.net/temp/tresensa/friendster";TGE.Achievements.SubmitScore=function(d){var b=new TGE.Achievements();b.submitScore(d)};TGE.Achievements.ShowAchievementsScreen=function(a){a.call()};TGE.Achievements.EnableParterUI=function(a){};TGE.Achievements.prototype={_achievements:[],_achievementIDs:[],createAchievement:function(e,b,d,a){this._achievements[e]=new TGE.Achievement(e,b,d,a);this._achievementIDs.push(e)},saveCompletedAchievements:function(){var g="";var b=this._achievementIDs.length;for(var d=0;d<b;d++){var e=this.getAchievementAt(d);if(e.hasBeenEarned()){g+=d;g+=" "}}var k="";b=g.length;for(c=0;c<b;c++){if(g.charAt(c)===" "){k+=Math.floor(Math.random()*10).toString()}else{k+=String.fromCharCode(g.charCodeAt(c)+50)}}if(k.length>0){var j=new Date();var f=999;j.setDate(j.getDate()+f);var h=k+((f==null)?"":"; expires="+j.toUTCString());document.cookie="tgeachv1="+h}},loadCompletedAchievements:function(){var e=null;var f,l,j,g=document.cookie.split(";");for(f=0;f<g.length;f++){l=g[f].substr(0,g[f].indexOf("="));j=g[f].substr(g[f].indexOf("=")+1);l=l.replace(/^\s+|\s+$/g,"");if(l=="tgeachv1"){e=j}}if(e){var d="";len=e.length;for(c=0;c<len;c++){var h=e.charCodeAt(c);if(e.charCodeAt(c)<=57){d+=" "}else{d+=String.fromCharCode(e.charCodeAt(c)-50)}}var b=d.split(" ");for(var k=0;k<b.length;k++){if(b[k].length>0){this.earnedAchievementAt(parseInt(b[k]),true)}}}},clearAchievements:function(){var d=new Date();var a=999;d.setDate(d.getDate()+a);var b=""+((a==null)?"":"; expires="+d.toUTCString());document.cookie="tgeachv1="+b},numberOfAchievements:function(){return this._achievementIDs.length},getAchievement:function(a){return this._achievements[a]},getAchievementAt:function(a){return this.getAchievement(this._achievementIDs[a])},earnedAchievementAt:function(b,a){this.earnedAchievement(this._achievementIDs[b],a)},earnedAchievement:function(d,b){b=typeof b==="undefined"?false:b;var a=this._achievements[d];if(a){if(!a.hasBeenEarned()){a.earned();if(!b&&this.earnedAchievementCallback){this.earnedAchievementCallback.call(null,a)}this.submitAchievementToPartner(a,b);this.saveCompletedAchievements()}}},submitScore:function(b){var a=false;if(TGE.Achievements.BestScore===null){TGE.Achievements.BestScore=b;a=false}else{if(TGE.Achievements.HigherScoresAreBetter&&b>TGE.Achievements.BestScore){TGE.Achievements.BestScore=b;a=true}else{if(!TGE.Achievements.HigherScoresAreBetter&&b<TGE.Achievements.BestScore){TGE.Achievements.BestScore=b;a=true}}}},submitAchievementToPartner:function(a,b){}};TGE.PlatformCompatibility=function(){return this};TGE.PlatformCompatibility.prototype={isAudioSupported:function(){var b=document.createElement("audio"),a=false;try{if(a=!!b.canPlayType){a=new Boolean(a);a.ogg=b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");a.mp3=b.canPlayType("audio/mpeg;").replace(/^no$/,"");a.wav=b.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");a.m4a=(b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/aac;")).replace(/^no$/,"")}}catch(d){}return a},isAudioFormatSupported:function(a){var f=document.createElement("audio"),b=false;var d;try{if(b=!!f.canPlayType){b=new Boolean(b);switch(a){case"ogg":d=f.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");break;case"mp3":d=f.canPlayType("audio/mpeg;").replace(/^no$/,"");break;case"wav":d=f.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");break;case"m4a":d=(f.canPlayType("audio/x-m4a;")||f.canPlayType("audio/aac;")).replace(/^no$/,"");break;default:break}}}catch(g){}return d},isCanvasSupported:function(){var a=document.createElement("canvas");return !!(a.getContext&&a.getContext("2d"))},isVideoSupported:function(){var b=document.createElement("video"),a=false;try{if(a=!!b.canPlayType){a=new Boolean(a);a.ogg=b.canPlayType('video/ogg; codecs="theora"');a.h264=b.canPlayType('video/mp4; codecs="avc1.42E01E"');a.webm=b.canPlayType('video/webm; codecs="vp8, vorbis"')}}catch(d){}return a},isDragAndDropSupported:function(){var a=document.createElement("div");bool=("draggable" in a)||("ondragstart" in a&&"ondrop" in a);return bool},isGeolocationSupported:function(){return !!navigator.geolocation},isWebGlSupported:function(){try{var b=document.createElement("canvas"),a;a=!!(window.WebGLRenderingContext&&(b.getContext("experimental-webgl")||b.getContext("webgl")));b=undefined}catch(d){a=false}return a},isHistorySupported:function(){return !!(window.history&&history.pushState)},isVideoSupported:function(){var b=document.createElement("video"),a=false},isLocalStorageSupported:function(){try{localStorage.setItem(mod,mod);localStorage.removeItem(mod);return true}catch(a){return false}},isSessionStorageSupported:function(){try{sessionStorage.setItem(mod,mod);sessionStorage.removeItem(mod);return true}catch(a){return false}},isSVGSupported:function(){ns={svg:"http://www.w3.org/2000/svg"};return !!document.createElementNS&&!!document.createElementNS(ns.svg,"svg").createSVGRect}};TGE.DeviceOrientation=function(){return this};TGE.DeviceOrientation.prototype={orientationChangeCallBack:null,RegisterOrientationChange:function(a){TGE.DeviceOrientation.prototype.orientationChangeCallBack=a;window.addEventListener("orientationchange",TGE.DeviceOrientation.prototype.internalOrientationChanged);TGE.DeviceOrientation.prototype.internalOrientationChanged()},internalOrientationChanged:function(){if(window.orientation===90||window.orientation===-90){TGE.DeviceOrientation.prototype.orientationChangeCallBack("landscape")}else{TGE.DeviceOrientation.prototype.orientationChangeCallBack("portrait")}}};var Sha1={};Sha1.hash=function(h,z){z=(typeof z=="undefined")?true:z;if(z){h=Utf8.encode(h)}var n=[1518500249,1859775393,2400959708,3395469782];h+=String.fromCharCode(128);var x=h.length/4+2;var k=Math.ceil(x/16);var m=new Array(k);for(var A=0;A<k;A++){m[A]=new Array(16);for(var y=0;y<16;y++){m[A][y]=(h.charCodeAt(A*64+y*4)<<24)|(h.charCodeAt(A*64+y*4+1)<<16)|(h.charCodeAt(A*64+y*4+2)<<8)|(h.charCodeAt(A*64+y*4+3))}}m[k-1][14]=((h.length-1)*8)/Math.pow(2,32);m[k-1][14]=Math.floor(m[k-1][14]);m[k-1][15]=((h.length-1)*8)&4294967295;var u=1732584193;var r=4023233417;var q=2562383102;var p=271733878;var o=3285377520;var f=new Array(80);var F,E,D,C,B;for(var A=0;A<k;A++){for(var v=0;v<16;v++){f[v]=m[A][v]}for(var v=16;v<80;v++){f[v]=Sha1.ROTL(f[v-3]^f[v-8]^f[v-14]^f[v-16],1)}F=u;E=r;D=q;C=p;B=o;for(var v=0;v<80;v++){var w=Math.floor(v/20);var g=(Sha1.ROTL(F,5)+Sha1.f(w,E,D,C)+B+n[w]+f[v])&4294967295;B=C;C=D;D=Sha1.ROTL(E,30);E=F;F=g}u=(u+F)&4294967295;r=(r+E)&4294967295;q=(q+D)&4294967295;p=(p+C)&4294967295;o=(o+B)&4294967295}return Sha1.toHexStr(u)+Sha1.toHexStr(r)+Sha1.toHexStr(q)+Sha1.toHexStr(p)+Sha1.toHexStr(o)};Sha1.f=function(b,a,e,d){switch(b){case 0:return(a&e)^(~a&d);case 1:return a^e^d;case 2:return(a&e)^(a&d)^(e&d);case 3:return a^e^d}};Sha1.ROTL=function(a,b){return(a<<b)|(a>>>(32-b))};Sha1.toHexStr=function(e){var d="",a;for(var b=7;b>=0;b--){a=(e>>>(b*4))&15;d+=a.toString(16)}return d};var Utf8={};Utf8.encode=function(a){var b=a.replace(/[\u0080-\u07ff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(192|d>>6,128|d&63)});b=b.replace(/[\u0800-\uffff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(224|d>>12,128|d>>6&63,128|d&63)});return b};Utf8.decode=function(b){var a=b.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var d=((e.charCodeAt(0)&15)<<12)|((e.charCodeAt(1)&63)<<6)|(e.charCodeAt(2)&63);return String.fromCharCode(d)});a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var d=(e.charCodeAt(0)&31)<<6|e.charCodeAt(1)&63;return String.fromCharCode(d)});return a};