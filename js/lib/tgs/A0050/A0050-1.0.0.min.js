/* Copyright (c) 2013 TreSensa, Inc. All Rights Reserved. */
!function(){TGS.Adapters.A0050=function(){TGS.Adapters.A0050.superclass.constructor.call(this),TGS.DataStore._sSaveToLocalStorage=!0,TGS.DataStore._sSaveToTGSServer=!1},TGS.Adapters.A0050.prototype={priceAsFormattedString:function(a){return 0===a?"FREE":TGS.PartnerBridge.prototype.priceAsFormattedString.call(this,a)},loginIcon:function(){return TGS._IMAGES_LOCATION+"android_login.png"},supportsMicrotransactions:function(){return!0},connect:function(){TGS.Debug.Log(TGS.Debug.LOG_INFO,"Wild Tangent adapter connecting...");for(var a=0;a<TGS.Microtransactions._sIAPProducts.length;a++)TGS.Microtransactions._sIAPProducts[a].consumable||(TGS.Microtransactions._sIAPProducts[a].price=0);this.getLoginStatus(),window.plugins.wildTangentPlugin&&plugins.wildTangentPlugin.init({partner:CordovaConfig.WildTangent.PARTNER||"tresensa",site:CordovaConfig.WildTangent.SITE,game:CordovaConfig.WildTangent.GAME,appid:CordovaConfig.WildTangent.APPID,publicSignature:CordovaConfig.WildTangent.PUBLIC_SIGNATURE,userId:TGS._sUserID},function(a){a&&(TGS.Debug.Log(TGS.Debug.LOG_INFO,"Completing pending purchase for ",a.item.id),a.partnerTransactionID="restart-purchase",TGS.Microtransactions._PartnerPurchaseSuccessful(a)),TGS.Debug.Log(TGS.Debug.LOG_INFO,"Wild Tangent adapter connected.")}.bind(this),function(a){TGS.Debug.Log(TGS.Debug.LOG_INFO,"Wild Tangent adapter init fails with "+a),this._mIsReady=!1}.bind(this))},purchaseItem:function(a){var b=a.item.partnerProductID;if(TGS.Debug.Log(TGS.Debug.LOG_INFO,"Wild Tangent purchase request for "+a.item.id+" ("+b+")."),0===a.item.price){a.partnerTransactionID="free-purchase";var c=TGS.LoadingOverlay();setTimeout(function(){c.parentNode.removeChild(c),TGS.Microtransactions._PartnerPurchaseSuccessful(a)},750)}else plugins.wildTangentPlugin.purchaseItem(b,a,function(a){TGS.Debug.Log(TGS.Debug.LOG_INFO,"Wild Tangent purchase accepted. "+JSON.stringify(a,null,2));var b=TGS.Microtransactions._PendingRequest;null!==b&&(b.partnerTransactionID=a.Nonce,TGS.Microtransactions._PartnerPurchaseSuccessful(b))},function(b){a.internalErrorMessage=b,TGS.Microtransactions._PartnerPurchaseFailed(a)})},advertising_injectAd:function(){},advertising_closeAd:function(){},advertising_injectInterstitial:function(a){loadingOverlay=TGS.LoadingOverlay(),plugins.wildTangentPlugin.showInterstitial(function(){loadingOverlay.parentNode.removeChild(loadingOverlay),a.closeCallback&&a.closeCallback()})},analytics_getProviders:function(){return[TGS.Analytics.NativeGoogleAnalyticsProvider]}},extend(TGS.Adapters.A0050,TGS.PartnerBridge)}();